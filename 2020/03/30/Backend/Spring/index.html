<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Spring - Shiyu - Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Shiyu - Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Shiyu - Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Inversion of controlThe approach of outsourcing(外包) the construction and management of objects(outsource to a object factory)."><meta property="og:type" content="blog"><meta property="og:title" content="Spring"><meta property="og:url" content="https://shiyuliucolumbia.github.io/2020/03/30/Backend/Spring/"><meta property="og:site_name" content="Shiyu - Blog"><meta property="og:description" content="Inversion of controlThe approach of outsourcing(外包) the construction and management of objects(outsource to a object factory)."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/IOC1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/BeanScope1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/BeanScope2.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/BeanLifeCycle1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/SpringMVC1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/DAO1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/service1.png"><meta property="og:image" content="https://shiyuliucolumbia.github.io/images/blog/Spring/service2.png"><meta property="article:published_time" content="2020-03-31T01:56:33.000Z"><meta property="article:modified_time" content="2021-11-12T15:14:27.476Z"><meta property="article:author" content="Shiyu Liu"><meta property="article:tag" content="Java"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/blog/Spring/IOC1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiyuliucolumbia.github.io/2020/03/30/Backend/Spring/"},"headline":"Spring","image":["https://shiyuliucolumbia.github.io/images/blog/Spring/IOC1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/BeanScope1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/BeanScope2.png","https://shiyuliucolumbia.github.io/images/blog/Spring/BeanLifeCycle1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/SpringMVC1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/DAO1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/service1.png","https://shiyuliucolumbia.github.io/images/blog/Spring/service2.png"],"datePublished":"2020-03-31T01:56:33.000Z","dateModified":"2021-11-12T15:14:27.476Z","author":{"@type":"Person","name":"Shiyu Liu"},"publisher":{"@type":"Organization","name":"Shiyu - Blog","logo":{"@type":"ImageObject","url":{"text":"Shiyu - Blog"}}},"description":"Inversion of controlThe approach of outsourcing(外包) the construction and management of objects(outsource to a object factory)."}</script><link rel="canonical" href="https://shiyuliucolumbia.github.io/2020/03/30/Backend/Spring/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Shiyu - Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-03-31T01:56:33.000Z" title="3/30/2020, 8:56:33 PM">2020-03-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-11-12T15:14:27.476Z" title="11/12/2021, 9:14:27 AM">2021-11-12</time></span><span class="level-item"><a class="link-muted" href="/categories/Backend/">Backend</a></span><span class="level-item">an hour read (About 9625 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Spring</h1><div class="content"><h1 id="Inversion-of-control"><a href="#Inversion-of-control" class="headerlink" title="Inversion of control"></a>Inversion of control</h1><p>The approach of outsourcing(外包) the construction and management of objects(outsource to a object factory).</p>
<span id="more"></span>

<p>下面这段程序是一个普通的java程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Coach theCoach = <span class="keyword">new</span> TrackCoach();</span><br><span class="line">		System.out.println(theCoach.getDailyWorkout());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Java编程中我们通常直接使用new创建一个新的对象，这样类和类之间存在高耦合，也就是说如果我们想要此时不想要TrackCoach给我们建议而是让其他Coach给我们建议，我们只能更改源代码。而IOC就是为了解决这个问题，对象的创建由Spring Container(Object Factory)帮我们创建。<br><img src="/images/blog/Spring/IOC1.png"></p>
<p>Spring Container的主要功能：1.Create and Manage objects(IOC) 2.Inject object’s dependencies(Dependency Injection)</p>
<p>我们使用Spring Container之前需要进行配置，主要有三种方式：1.XML file(legacy, but most legacy apps use it) 2.Java annotation(modern)  3.Java source code(modern)</p>
<h2 id="XML-file-configuration"><a href="#XML-file-configuration" class="headerlink" title="XML file configuration"></a>XML file configuration</h2><p>IOC Spring程序的开发流程：<br>1.Configure your Spring Beans<br>什么是Spring Beans？<br>A “Spring Bean” is simply a Java object.<br>When Java objects are created by the Spring Container, then Spring refers to them as “Spring Beans”.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.TrackCoach&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2.Create a Spring Container<br>Spring Container is generally known as ApplicationContect. 它有一些具体的实现: ClassPathXmlApplicationContext, AnnotationApplicationContext, GenericWebApplicationContext…<br>这里我们先用xml配置的这种。<br>3.Retrieve Beans from Spring Container</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloSpringApp</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//load spring configuration file, Create a Spring Container </span></span><br><span class="line">		ClassPathXmlApplicationContext context  = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//retrieve bean from spring </span></span><br><span class="line">		Coach theCoach = context.getBean(<span class="string">&quot;myCoach&quot;</span>, Coach.class);<span class="comment">//这里我们在getBean方法后面加上Coach.class，spring会自动帮我们进行类型转换</span></span><br><span class="line">		<span class="comment">//call methods on the bean</span></span><br><span class="line">		System.out.println(theCoach.getDailyWorkout());</span><br><span class="line">		<span class="comment">//close the context</span></span><br><span class="line">		context.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Coach theCoach = context.getBean(&quot;myCoach&quot;, Coach.class);</code>, 这里我们在getBean方法后面加上Coach.class，spring会自动帮我们进行类型转换, 这样比直接自己手动转换<code>Coach theCoach = (Coach) context.getBean(&quot;myCoach&quot;);</code>的好处是provides a measure of type safety by throwing a BeanNotOfRequiredTypeException if the bean is not of the required type. </p>
<h2 id="Java-Annotation"><a href="#Java-Annotation" class="headerlink" title="Java Annotation"></a>Java Annotation</h2><p>Java Annotations are special labels/marks added to Java classes whcih provide meta-data about the class and proceed at compile time or run-time for special processing.<br><strong>Thus spring will scan java classes for special annotations and automatically register the beans in the Spring container.</strong><br>所以使用Java Annotations开发IOC Spring程序的流程是：</p>
<ol>
<li>Enable component scanning in Spring config file.<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- add entry to enable component running --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.luv2code.springdemo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Add <code>@Component</code> Annotation to your java classes.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Retrieve Beans from Spring Container.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationDemoApp</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//read spring config file</span></span><br><span class="line">		ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//get the bean from spring container</span></span><br><span class="line">		Coach theCoach = context.getBean(<span class="string">&quot;thatSillyCoach&quot;</span>, Coach.class);<span class="comment">//这里的名字就是我们在annotation定义的ID</span></span><br><span class="line">		<span class="comment">//call a method on the bean</span></span><br><span class="line">		System.out.println(theCoach.getDailyWorkout());</span><br><span class="line">		<span class="comment">//close the context</span></span><br><span class="line">		context.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>Spring也支持不写Bean ID，那么它默认的Bean ID就是class name的首字母小写：比如TennisCoach类，那么我们用的时候就是”tennisCoach”</p>
<h1 id="Dependency-Injection"><a href="#Dependency-Injection" class="headerlink" title="Dependency Injection"></a>Dependency Injection</h1><p>Dependency Injection指的是如果我们跟object factory要一个car object，car object由许多包括tire object, seat object, engine object组成，那么object factory会自动帮我们组装好，这就是依赖注入。<br>“dependency” is the same thing as “helper objects”.</p>
<p>Injection Types: 1. Construction Injection 2. Setter Injection 3.auto-wiring(in annotation section)</p>
<h2 id="XML-configurarion-Construction-injection"><a href="#XML-configurarion-Construction-injection" class="headerlink" title="XML configurarion - Construction injection"></a>XML configurarion - Construction injection</h2><p>Construction injection的开发流程:</p>
<ol>
<li>Define the dependency interface and class<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HappyFortuneService</span> <span class="keyword">implements</span> <span class="title">FortuneService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Today is your lucky day&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Create a constructor in your class for injections<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseballCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span></span>&#123;</span><br><span class="line">	<span class="comment">//define a private field for the dependency</span></span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	<span class="comment">//define a constructor for dependency injection</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">BaseballCoach</span><span class="params">(FortuneService theFortuneService)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.fortuneService = theFortuneService;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Spend 30 minutes on batting practise&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//use my fortuneService to get a fortune</span></span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Configure the dependency injdection in spring config file<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">&lt;!-- define the dependency(helper object) --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myFortune&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.HappyFortuneService&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.BaseballCoach&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- set up constructor injection --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
当我们配置好后，这个时候再在主程序中执行<code>Coach theCoach = (Coach) context.getBean(&quot;myCoach&quot;);</code>，这个时候spring container(object factory)就会按照IOC和DI把组装好的对象直接给我们用了。</li>
</ol>
<hr>
<p><strong>所以Dependency Injection帮我们做了什么呢？</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">&lt;!-- define the dependency(helper object) --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myFortune&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.HappyFortuneService&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.BaseballCoach&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- set up constructor injection --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>等价于</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HappyFortuneService myFortuneService = <span class="keyword">new</span> HappyFortuneService();<span class="comment">//Dependency Injection帮助我们创建helper object，并帮我们注入到我们需要的Bean里面</span></span><br><span class="line">BaseballCoach myCoach = <span class="keyword">new</span> BaseballCoach(myFortuneService);<span class="comment">//这里Spring调用的是BaseballCoach的constructor是IOC的作用</span></span><br></pre></td></tr></table></figure>

<p>IOC+DI使得我们的程序耦合度非常低，所有的关键信息都在配置文件中体现，我们的程序的高度可复用的！</p>
<h2 id="XML-configurarion-Setter-injection"><a href="#XML-configurarion-Setter-injection" class="headerlink" title="XML configurarion - Setter injection"></a>XML configurarion - Setter injection</h2><p>Setter Injection的开发流程：</p>
<ol>
<li>Define the dependency interface and class</li>
<li>Create setter method in your class for injection<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CricketCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CricketCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Call Cricket Coach Constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// our setter method</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFortuneService</span><span class="params">(FortuneService fortuneService)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Call Cricket Coach setter method&quot;</span>);</span><br><span class="line">		<span class="keyword">this</span>.fortuneService = fortuneService;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise fast bowling for 15 minutes&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Configure the dependency injdection in spring config file<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCricketCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.CricketCoach&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fortuneService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
 spring会去寻找name属性对应的setter函数进行依赖注入，寻找的原则是set+name(首字母大写)，所以这里会去找setFortuneService()这个函数。</li>
</ol>
<p>从输出可以看出spring在setter依赖注入时先调用没有参数的constructor，然后调用setter进行依赖注入。</p>
<hr>
<p>上面依赖注入的是类，如果注入的是String的话则有不一样的用法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCricketCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.CricketCoach&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- set up setter injection --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fortuneService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- inject literal values --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;emailAddress&quot;</span> <span class="attr">value</span>=<span class="string">&quot;shiyuliucu@gmail.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;team&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Sachid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>更好的做法是把value写在properties file。</p>
<ol>
<li>create properties file<br>创建一个sport.properties文件，在里面加入这两行<br>foo.email = <a href="mailto:&#115;&#x68;&#105;&#121;&#x75;&#108;&#x69;&#117;&#x63;&#117;&#64;&#103;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#x6d;">&#115;&#x68;&#105;&#121;&#x75;&#108;&#x69;&#117;&#x63;&#117;&#64;&#103;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#x6d;</a><br>foo.team = Sachid</li>
<li>load properties file in spring config file</li>
</ol>
<p><code>&lt;context:property-placeholder location=&quot;classpath:sport.properties&quot; /&gt;</code></p>
<ol start="3">
<li>reference values from properties file</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:sport.properties&quot;</span> /&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- define the dependency(helper object) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myFortune&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.HappyFortuneService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.BaseballCoach&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- set up constructor injection --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCricketCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.CricketCoach&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- set up setter injection --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fortuneService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- inject literal values --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;emailAddress&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;foo.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;team&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;foo.team&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Java-Annotations-Autowiring-Contructor-Injection"><a href="#Java-Annotations-Autowiring-Contructor-Injection" class="headerlink" title="Java Annotations(Autowiring) - Contructor Injection"></a>Java Annotations(Autowiring) - Contructor Injection</h2><p>For dependency injection, Spring can use auto wiring. Spring will look for a class or interface that matches the property. And then, Spring will inject it automatically.<br>Autowiring的实现过程：Spring会扫描所有的@Component注解，如果发现里面有@autowired注解的成员变量，那么就会去找相对应的实现类并自动进行依赖注入。</p>
<p>开发流程是：</p>
<ol>
<li>Define the independency interface and class</li>
<li>Create a constructor in your class for injection</li>
<li>Configure the dependency injection with @Autowired Annotation<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">(FortuneService fs)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.fortuneService = fs;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Java-Annotations-Autowiring-Setter-Injection"><a href="#Java-Annotations-Autowiring-Setter-Injection" class="headerlink" title="Java Annotations(Autowiring) - Setter Injection"></a>Java Annotations(Autowiring) - Setter Injection</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFortuneService</span><span class="params">(FortuneService fortuneService)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.fortuneService = fortuneService;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Java-Annotations-Autowiring-Field-Injection"><a href="#Java-Annotations-Autowiring-Field-Injection" class="headerlink" title="Java Annotations(Autowiring) - Field Injection"></a>Java Annotations(Autowiring) - Field Injection</h2><p>其实最简单的方式是我们直接在class的fields上标注@Autowired，那么他们就会自动进行依赖注入，这是通过java的反射机制完成的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Java-Annotations-Autowiring-Qualifiers"><a href="#Java-Annotations-Autowiring-Qualifiers" class="headerlink" title="Java Annotations(Autowiring) - Qualifiers"></a>Java Annotations(Autowiring) - Qualifiers</h2><p><strong>现在出现了一个很严重的问题：前面我们的接口只有一个实现类，所以spring直到要用这个类进行依赖注入，但是如果对于一个接口有多个实现类呢？这个时候就用到了Qualifiers(限定词)</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier(&quot;happyFortuneService&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Qualifier使用的必须是想用的类的类名(首字母小写)</p>
<h2 id="Some-tips"><a href="#Some-tips" class="headerlink" title="Some tips"></a>Some tips</h2><p><strong>Annotations - Default Bean Names … and the Special Case</strong><br>In general, when using Annotations, for the default bean name, Spring uses the following rule.<br>If the annotation’s value doesn’t indicate a bean name, an appropriate name will be built based on the short name of the class (with the first letter lower-cased).<br>For example:<br>HappyFortuneService –&gt; happyFortuneService<br>However, for the special case of when BOTH the first and second characters of the class name are upper case, then the name is NOT converted.<br>For the case of RESTFortuneService<br>RESTFortuneService –&gt; RESTFortuneService<br>No conversion since the first two characters are upper case.<br>Behind the scenes, Spring uses the Java Beans Introspector to generate the default bean name. Here’s a screenshot of the documentation for the key method.<br><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/beans/Introspector.html#decapitalize(java.lang.String)">https://docs.oracle.com/javase/8/docs/api/java/beans/Introspector.html#decapitalize(java.lang.String)</a></p>
<hr>
<p><strong>Using @Qualifier with Constructors</strong><br>@Qualifier is a nice feature, but it is tricky when used with Constructors.</p>
<p>The syntax is much different from other examples and not exactly intuitive.  Consider this the “deep end of the pool” when it comes to Spring configuration LOL :-)</p>
<p> You have to place the @Qualifier annotation inside of the constructor arguments. </p>
<p>Here’s an example from our classroom example. I updated it to make use of constructor injection, with @Autowired and @Qualifier. Make note of the code in bold below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// define a default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt; TennisCoach: inside default constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">(<span class="meta">@Qualifier(&quot;randomFortuneService&quot;)</span> FortuneService theFortuneService)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;&gt;&gt; TennisCoach: inside constructor using @autowired and @qualifier&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        fortuneService = theFortuneService;</span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    @Autowired</span></span><br><span class="line"><span class="comment">    public void doSomeCrazyStuff(FortuneService theFortuneService) &#123;</span></span><br><span class="line"><span class="comment">        System.out.println(&quot;&gt;&gt; TennisCoach: inside doSomeCrazyStuff() method&quot;);</span></span><br><span class="line"><span class="comment">        fortuneService = theFortuneService;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    @Autowired</span></span><br><span class="line"><span class="comment">    public TennisCoach(FortuneService theFortuneService) &#123;</span></span><br><span class="line"><span class="comment">        fortuneService = theFortuneService;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Practice your backhand volley&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For detailed documentation on using @Qualified with Constructors, see this link in the Spring Reference Manual<br><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-autowired-annotation-qualifiers">https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#beans-autowired-annotation-qualifiers</a></p>
<hr>
<p><strong>How to inject properties file using Java annotations</strong><br>FAQ: How to inject properties file using Java annotations</p>
<p>Answer:</p>
<p>This solution will show you how inject values from a properties file using annotatons. The values will no longer be hard coded in the Java code.</p>
<ol>
<li>Create a properties file to hold your properties. It will be a name value pair.<br>New text file:  src/sport.properties</li>
</ol>
<p>foo.email=<a href="mailto:&#x6d;&#x79;&#101;&#x61;&#115;&#121;&#99;&#111;&#x61;&#x63;&#104;&#64;&#x6c;&#117;&#118;&#50;&#x63;&#111;&#x64;&#101;&#46;&#x63;&#111;&#x6d;">&#x6d;&#x79;&#101;&#x61;&#115;&#121;&#99;&#111;&#x61;&#x63;&#104;&#64;&#x6c;&#117;&#118;&#50;&#x63;&#111;&#x64;&#101;&#46;&#x63;&#111;&#x6d;</a><br>foo.team=Silly Java Coders<br>Note the location of the properties file is very important. It must be stored in src/sport.properties</p>
<ol start="2">
<li><p>Load the properties file in the XML config file.<br>File: applicationContext.xml<br>Add the following lines:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:sport.properties&quot;</span>/&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>This should appear just after the &lt;context:component-scan …/&gt; line</p>
</li>
<li><p>Inject the properties values into your Swim Coach: SwimCoach.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;foo.email&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line"><span class="meta">@Value(&quot;$&#123;foo.team&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String team;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Spring-Beans-Scopes-and-Lifecycle"><a href="#Spring-Beans-Scopes-and-Lifecycle" class="headerlink" title="Spring Beans Scopes and Lifecycle"></a>Spring Beans Scopes and Lifecycle</h1><h2 id="Beans-Scopes"><a href="#Beans-Scopes" class="headerlink" title="Beans Scopes"></a>Beans Scopes</h2><p>Scope指的是Bean对象的作用范围</p>
<ul>
<li>How long does a bean live</li>
<li>How many instances are created</li>
<li>How is the bean shared</li>
</ul>
<p>1.默认的作用范围是singleton</p>
<ul>
<li>Spring container(Object Factory) 只会默认为这个bean创建一个实例</li>
<li>It is cashed in memory</li>
<li>All requests for the bean will return a SHARED reference to the same BEAN<br><img src="/images/blog/Spring/BeanScope1.png"></li>
</ul>
<p>2.prototype: Creates a new bean instance for each container request<br><img src="/images/blog/Spring/BeanScope2.png"><br>3.request: Scoped to a HTTP web request. Only used for web apps.<br>4.session: Scoped to a HTTP web session. Only used for web apps.<br>5.global-session: Scoped to a global HTTP web session. Only used for web apps.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanScopeDemoApp</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;beanScope-applicationContext.xml&quot;</span>);</span><br><span class="line">		Coach theCoach = context.getBean(<span class="string">&quot;myCoach&quot;</span>, Coach.class);</span><br><span class="line">		Coach alphaCoach = context.getBean(<span class="string">&quot;myCoach&quot;</span>, Coach.class);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//check if they are the same</span></span><br><span class="line">		System.out.println(theCoach==alphaCoach);</span><br><span class="line">		</span><br><span class="line">		context.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>singleton模式下结果是true，prototype模式下结果是false。</p>
<hr>
<p>我们也可以使用Anotation @Scope：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span><span class="comment">//在这里进行scope的注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier(&quot;happyFortuneService&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Beans-lifecycle"><a href="#Beans-lifecycle" class="headerlink" title="Beans lifecycle"></a>Beans lifecycle</h2><p><img src="/images/blog/Spring/BeanLifeCycle1.png"></p>
<p>we can add custom code during bean intialization</p>
<ul>
<li>calling custom business logic method</li>
<li>setting up handles to resources(db, sockets, file, etc)</li>
</ul>
<p>we can add custom code during bean destruction</p>
<ul>
<li>calling custom business logic method</li>
<li>cleaning up handles to resources(db, sockets, file, etc)</li>
</ul>
<p>使用initialization和destruction的方法是先定义init或者destroy函数，然后再spring配置文件中进行配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myCoach&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.luv2code.springdemo.TrackCoach&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">init-method</span>=<span class="string">&quot;doMyStartUpStuff&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;doMyCleanUpStuff&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- set up constructor injection --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;myFortune&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>我们也可以使用Annotation：@PostConstruct and @PreDestroy</p>
<p><strong>Special Note about @PostConstruct and @PreDestroy Method Signatures</strong></p>
<p>I want to provide additional details regarding the method signatures of @PostContruct and @PreDestroy methods.</p>
<p>Access modifier</p>
<p>The method can have any access modifier (public, protected, private)</p>
<p>Return type<br>The method can have any return type. However, “void’ is most commonly used. If you give a return type just note that you will not be able to capture the return value. As a result, “void” is commonly used.</p>
<p>Method name<br>The method can have any method name.</p>
<p>Arguments<br>The method can not accept any arguments. The method should be no-arg.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.PreDestroy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;thatSillyCoach&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TennisCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier(&quot;happyFortuneService&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TennisCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default constructor&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Practise your backhand volley&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@PostConstruct</span></span><br><span class="line">	<span class="comment">//define my init method</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doStartUpStuff</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default doStartUpStuff()&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@PreDestroy</span></span><br><span class="line">	<span class="comment">//define my destroy method</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doCleanUpStuff</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Tennis Coach: inside default doCleanUpStuff()&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Spring-Configuration-with-java-code-no-xml"><a href="#Spring-Configuration-with-java-code-no-xml" class="headerlink" title="Spring Configuration with java code(no xml)"></a>Spring Configuration with java code(no xml)</h1><p>3 ways to configure Spring Container:</p>
<ol>
<li>Full xml config</li>
<li>xml Component scan + Annotation</li>
<li>Java configuration class</li>
</ol>
<p>开发流程：</p>
<ol>
<li>Create a Java Class and annotate as @Configuration</li>
<li>Add component scanning support: @ComponentScan(optional)<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.luv2code.springdemo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SportConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Read Spring Configuration class</li>
<li>Retrieve bean from Spring container<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaConfigDemoApp</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//read spring config file</span></span><br><span class="line">		AnnotationConfigApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(SportConfig.class);</span><br><span class="line">		<span class="comment">//get the bean from spring container</span></span><br><span class="line">		Coach theCoach = context.getBean(<span class="string">&quot;thatSillyCoach&quot;</span>, Coach.class);</span><br><span class="line">		<span class="comment">//call a method on the bean</span></span><br><span class="line">		System.out.println(theCoach.getDailyWorkout());</span><br><span class="line">		System.out.println(theCoach.getDailyFortune());</span><br><span class="line">		<span class="comment">//close the context</span></span><br><span class="line">		context.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>Java config的方式不仅可以定义Spring Container，也可以定义Bean Object<br>开发流程：</p>
<ol>
<li>Define method to expose bean using @Bean</li>
<li>Inject bean dependencies<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="comment">//import org.springframework.context.annotation.ComponentScan;</span></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//@ComponentScan(&quot;com.luv2code.springdemo&quot;)  因为我们定义好Bean了，所以也不需要自动扫描了</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SportConfig</span> </span>&#123;</span><br><span class="line">	<span class="comment">//define bean for our sad fortune service</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> FortuneService <span class="title">sadFortuneService</span><span class="params">()</span> </span>&#123;<span class="comment">//函数名是Bean id</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SadFortuneService();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//define bean for our swim coach AND inject dependency</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Coach <span class="title">swimCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SwimCoach(sadFortuneService());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Read Spring Java configuration class</li>
<li>Retrieve bean from Spring Container<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwimJavaConfigDemoApp</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//read spring config file</span></span><br><span class="line">		AnnotationConfigApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(SportConfig.class);</span><br><span class="line">		<span class="comment">//get the bean from spring container</span></span><br><span class="line">		Coach theCoach = context.getBean(<span class="string">&quot;swimCoach&quot;</span>, Coach.class);</span><br><span class="line">		<span class="comment">//call a method on the bean</span></span><br><span class="line">		System.out.println(theCoach.getDailyWorkout());</span><br><span class="line">		System.out.println(theCoach.getDailyFortune());</span><br><span class="line">		<span class="comment">//close the context</span></span><br><span class="line">		context.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>使用java code从properties file中读取数据也是可以的。<br>开发流程是：</p>
<ol>
<li>Create properties file</li>
<li>Load properties file in Spring Config<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:Sport.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SportConfig</span> </span>&#123;</span><br><span class="line">	<span class="comment">//define bean for our sad fortune service</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> FortuneService <span class="title">sadFortuneService</span><span class="params">()</span> </span>&#123;<span class="comment">//函数名是Bean id</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SadFortuneService();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//define bean for our swim coach AND inject dependency</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Coach <span class="title">swimCoach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SwimCoach(sadFortuneService());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Reference Value from Properties File<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwimCoach</span> <span class="keyword">implements</span> <span class="title">Coach</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> FortuneService fortuneService;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;foo.email&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;foo.team&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String team;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getTeam</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> team;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SwimCoach</span><span class="params">(FortuneService fs)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.fortuneService = fs;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyWorkout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Swim 1000 meters as a wram up&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDailyFortune</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.fortuneService.getFortune();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Spring-MVC"><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h1><p><img src="/images/blog/Spring/SpringMVC1.png"></p>
<ul>
<li>Controller<ul>
<li>Code created by developer</li>
<li>Contains your business logic<ul>
<li>handle the request</li>
<li>store/retrieve data(db, web service…)</li>
<li>place data in a model</li>
</ul>
</li>
<li>send to appropriate view template</li>
</ul>
</li>
<li>Model<ul>
<li>contains your data</li>
<li>store/retrieve data via backend systems<ul>
<li>database, wev services …</li>
<li>using a spring bean if you like</li>
</ul>
</li>
<li>place your data in the model<ul>
<li>data can be any java object/collection</li>
</ul>
</li>
</ul>
</li>
<li>View Template<ul>
<li>Spring MVC is flexible<ul>
<li>support many view templates</li>
</ul>
</li>
<li>Most common is JSP+JSTL</li>
<li>developer creates a page<ul>
<li>display data</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h2><p>因为所有的java web项目本质上都是对servlets的封装并加入一些方便程序员编写的特性，所以配置SpringMVC的第一步就是在web.xml文件中配置Spring写好的DispatcherServlet，Servlet的相关知识包含在在<strong>Servlets and JSPs</strong>的课程里。</p>
<ul>
<li>JAR configuration: 将所需的jar file放入WebContent/WEBINF/lib中，eclipse自动将他们加载到项目的classpath中。所需的jar有spring core的jar和JSTL的jar</li>
<li>web.xml(配置servlet)<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;WebApp_ID&quot;</span> <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>spring-mvc-demo<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">absolute-ordering</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring MVC Configs --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Step 1: Configure Spring MVC Dispatcher Servlet --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet在启动前扫描spring-mvc-demo-servlet.xml的配置进行IOC和DI --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/WEB-INF/spring-mvc-demo-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Step 2: Set up URL mapping for Spring MVC Dispatcher Servlet --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这一句相当于所有访问的指定都会给到spring提供的这个servlet去 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>applicationContext.xml(这个demo里面名字叫spring-mvc-demo-servlet.xml)<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    	http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    	http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    	http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    	http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Step 3: Add support for component scanning --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.luv2code.springdemo&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Step 4: Add support for conversion, formatting and validation support --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Step 5: Define Spring MVC view resolver --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 	这里是告诉ViewResolver我们的jsp文件都放在什么地方了，这样SpringMVC才能找到它们。</span></span><br><span class="line"><span class="comment">	也就是ViewResolver会自动去/WEB-INF/view/文件夹下去找.jsp文件 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/view/&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Create-Controllers-and-Views"><a href="#Create-Controllers-and-Views" class="headerlink" title="Create Controllers and Views"></a>Create Controllers and Views</h2><p><strong>Basic Controller开发流程：</strong></p>
<ol>
<li>Create Controller Class<br>对class使用@Controller这个Annotation，@Controller继承自@Component，所以Spring也会自动扫描@Controller的类。</li>
<li>Define Controller Method</li>
<li>Add Request Mapping to Controller method</li>
<li>Return View Name<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showPage</span><span class="params">()</span> </span>&#123;<span class="comment">//函数名，参数都是随意的</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;main-menu&quot;</span>; <span class="comment">//由于我们的配置，spring会去找/WEB-INF/view/main-menu.jsp</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Develop View Page<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Spring MVC demo - Home Page&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Spring MVC demo - Home Page&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>Question<br><strong>How does component scan work in this example? You have different package names.</strong><br>You listed the component scan package as: com.luv2code.springdemo<br>But the our MVC controllers are defined in com.luv2code.springdemo.mvc</p>
<p>Answer<br>For the Spring attribute:  base-package=”com.luv2code.springdemo”<br>Spring will recursively scan for components starting at the base package: “com.luv2code.springdemo”<br>When I say “recursive”, it means that Spring will start at the base package and scan all sub packages.<br>The package com.luv2code.springdemo.mvc is a sub package because of naming structure, just like folders on a file system.<br>As a result, it will be included in the scan.</p>
<hr>
<p><strong>Controller进阶：读取html表格里的数据</strong><br><em>HelloWorldController.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//need a controller method to show the initial HTML form</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/showForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;helloworld-form&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//need a controller method to process the HTML form</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/processForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">processForm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>helloworld-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Hello World - Input Form&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;form action=<span class="string">&quot;processForm&quot;</span> method=<span class="string">&quot;get&quot;</span>&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;studentName&quot;</span> placeholder=<span class="string">&quot;what&#x27;s your name&quot;</span>  /&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span> /&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><em>helloworld.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Hello world of spring!&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- EL表达式，比我学的JSP进化了一些，不用写复杂的JAVA code了--&gt;</span><br><span class="line">    &lt;!-- Student Name: &lt;%= request.getParameter(<span class="string">&quot;studentName&quot;</span>) %&gt; --&gt;</span><br><span class="line">	Student Name: $&#123;param.studentName&#125; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>Controller进阶：Adding data to the Spring Model</strong><br>Spring Model:</p>
<ul>
<li>The Model is a container for your application data</li>
<li>In your controller<ul>
<li>You can put anything in a model</li>
<li>strings, object, info from database, etc…</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//need a controller method to show the initial HTML form</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/showForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;helloworld-form&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//need a controller method to process the HTML form</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/processForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">processForm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//new a controller method to read form data and add data to the model</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/processFormVersionTwo&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">letsShoutDude</span><span class="params">(HttpServletRequest request, Model model)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//read the request parameter from the HTML form</span></span><br><span class="line">		String theName = request.getParameter(<span class="string">&quot;studentName&quot;</span>);</span><br><span class="line">		<span class="comment">//convert data to all caps</span></span><br><span class="line">		theName = theName.toUpperCase();</span><br><span class="line">		<span class="comment">//create the message</span></span><br><span class="line">		String result = <span class="string">&quot;Yo! &quot;</span> + theName;</span><br><span class="line">		<span class="comment">//add message to model</span></span><br><span class="line">		model.addAttribute(<span class="string">&quot;message&quot;</span>, result);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Your view page(JSP) can access data from model</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Hello world of spring!&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	Student Name: $&#123;message&#125;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>Controller进阶： How do I use CSS, JavaScript and Images in a Spring MVC Web App?</strong><br>Here are the steps on how to access static resources in a Spring MVC. For example, you can use this to access images, css, JavaScript files etc.</p>
<p>Any static resource is processed as a URL Mapping in Spring MVC. You can configure references to static resources in the spring-mvc-demo-servlet.xml.</p>
<p>In my example, I’m going to have the following directory structure:<br>I chose to put everything in the “resources” directory. But you can use any name for “resources”, such as “assets”, “foobar” etc. Also, you can give any name that you want for the subdirectories under “resources”.</p>
<p>Step 1: Add the following entry to your Spring MVC configuration file: spring-mvc-demo-servlet.xml</p>
<p>You can place this entry anywhere in your Spring MVC config file.</p>
<p><code>&lt;mvc:resources mapping=&quot;/resources/**&quot; location=&quot;/resources/&quot;&gt;&lt;/mvc:resources&gt; </code></p>
<p>Step 2: Now in your view pages, you can access the static files using this syntax:</p>
<p><code>&lt;img src=&quot;$&#123;pageContext.request.contextPath&#125;/resources/images/spring-logo.png&quot;&gt;</code></p>
<p>You need to use the JSP expression ${pageContext.request.contextPath} to access the correct root directory for your web application.</p>
<p>Apply the same technique for reading CSS and JavaScript.</p>
<p>Here’s a full example that reads CSS, JavaScript and images.</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt; &lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span>          </span><br><span class="line"></span><br><span class="line">            href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/resources/css/my-test.css&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/resources/js/simple-test.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;Spring MVC Demo - Home Page&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">&quot;showForm&quot;</span>&gt;Plain Hello World&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/resources/images/spring-logo.png&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> onclick=<span class="string">&quot;doSomeWork()&quot;</span> value=<span class="string">&quot;Click Me&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


<h2 id="Request-Params-and-Request-Mapping"><a href="#Request-Params-and-Request-Mapping" class="headerlink" title="Request Params and Request Mapping"></a>Request Params and Request Mapping</h2><p><strong>Bind data using @RequestParam Annotation</strong><br>上面我们是使用<code>String theName = request.getParameter(&quot;studentName&quot;);</code>，Spring提供了@RequestParam注解来直接读取request的内容并bind到我们的参数中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/processFormVersionThree&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">processFormVersionThree</span><span class="params">(<span class="meta">@RequestParam(&quot;studentName&quot;)</span> String theName, Model model)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//convert data to all caps</span></span><br><span class="line">    theName = theName.toUpperCase();</span><br><span class="line">    <span class="comment">//create the message</span></span><br><span class="line">    String result = <span class="string">&quot;Yo! &quot;</span> + theName;</span><br><span class="line">    <span class="comment">//add message to model</span></span><br><span class="line">    model.addAttribute(<span class="string">&quot;message&quot;</span>, result);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;helloworld&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们需要理解的是：这里我们是因为要对request params进行处理，所以先将request params使用@RequestParam绑定到theName变量上，再将处理后的结果放入model中让我们的前端接收到，但是其实在前端仍旧是可以使用<code>&#123;$param.studentName&#125;</code>去获取最初始的request params的，只不过拿到的是没处理过得！</p>
<hr>
<p><strong>Controller level Request Mapping</strong><br>我们可以在Controller层面添加一个Request Mapping，那么我们所有函数的Request Mapping都将相对于这个路径。</p>
<h2 id="Spring-MVC-Form-Tags-and-data-binding"><a href="#Spring-MVC-Form-Tags-and-data-binding" class="headerlink" title="Spring MVC Form Tags and data binding"></a>Spring MVC Form Tags and data binding</h2><p>Spring MVC Form Tags are the building block for a web page. Form Tags are configurable and resuable for a web page.<br><strong>Spring MVC Form Tags can make use of data binding. Automatically setting/retrieving data from a Java Bean/Object.</strong></p>
<p><strong>Text Fields</strong><br><em>student-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">    </span><br><span class="line">&lt;!-- 用了这一句我们才能使用Form Tags --&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Registration Form&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- modelAttribute对应着我们加入model的对象的名字 --&gt;</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;processForm&quot;</span> modelAttribute=<span class="string">&quot;student&quot;</span>&gt;</span><br><span class="line">		&lt;!-- path对应着对象的变量名 --&gt;</span><br><span class="line">		First Name: &lt;form:input path=<span class="string">&quot;firstName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Last Name: &lt;form:input path=<span class="string">&quot;lastName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span>/&gt;</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>When form is loaded, Spring MVC will call <code>student.getFirstName()</code>, <code>student.getLastName()</code>. 也就是Spring根据modelAttribute和path去自动调用get函数。<br>When form is submitted, Spring MVC will call <code>student.setFirstName()</code>, <code>student.setLastName()</code>.</p>
<p><em>Student.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String firstName;</span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em>StudentController.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ModelAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/showForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a student object</span></span><br><span class="line">		Student theStudent = <span class="keyword">new</span> Student();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//add student object to the model</span></span><br><span class="line">							<span class="comment">//NAME      VALUE</span></span><br><span class="line">		model.addAttribute(<span class="string">&quot;student&quot;</span>, theStudent);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;student-form&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/processForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">processForm</span><span class="params">(<span class="meta">@ModelAttribute(&quot;student&quot;)</span> Student theStudent)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;student-confirmation&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>student-confirmation.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Confirmation&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	The student is confirmed: $&#123;student.firstName&#125; $&#123;student.lastName&#125; </span><br><span class="line">	&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>student.firstName会call student.getFirstName()函数。</p>
<p>我们需要理解的是：这里我们是直接从student-form.jsp把Model传给student-confirmation.form，然后在前端我们直接使用绑定好的<code>&#123;$student.firstName&#125;</code>即可。但是request params仍旧是存在的，我们在前端仍旧可以使用<code>&#123;$param。firstName&#125;</code>来获取数据，只是为了符合MVC里的Model的概念，我们希望在Controller之间传递的是Model而不是一个又一个的参数！</p>
<hr>
<p><strong>Drop Down Lists</strong><br><em>student-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">    </span><br><span class="line">&lt;!-- 用了这一句我们才能使用Form Tags --&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Registration Form&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- modelAttribute对应着我们加入model的对象的名字 --&gt;</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;processForm&quot;</span> modelAttribute=<span class="string">&quot;student&quot;</span>&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Text Fields --&gt;</span><br><span class="line">		&lt;!-- path对应着对象的变量名 --&gt;</span><br><span class="line">		First Name: &lt;form:input path=<span class="string">&quot;firstName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Last Name: &lt;form:input path=<span class="string">&quot;lastName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Dropdown Lists --&gt;</span><br><span class="line">		Country: </span><br><span class="line">		&lt;form:select path=<span class="string">&quot;country&quot;</span>&gt;</span><br><span class="line">			&lt;!-- value是java code的值，label是在网页上显示的值 --&gt;</span><br><span class="line">			&lt;form:option value=<span class="string">&quot;Brasil&quot;</span> label=<span class="string">&quot;BRA&quot;</span>&gt;&lt;/form:option&gt;</span><br><span class="line">			&lt;form:option value=<span class="string">&quot;France&quot;</span> label=<span class="string">&quot;Fra&quot;</span>&gt;&lt;/form:option&gt;</span><br><span class="line">			&lt;form:option value=<span class="string">&quot;Germany&quot;</span> label=<span class="string">&quot;DEU&quot;</span>&gt;&lt;/form:option&gt;</span><br><span class="line">			&lt;form:option value=<span class="string">&quot;India&quot;</span> label=<span class="string">&quot;INR&quot;</span>&gt;&lt;/form:option&gt;</span><br><span class="line">		&lt;/form:select&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span>/&gt;</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><em>student-confirmation.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Confirmation&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	The student is confirmed: $&#123;student.firstName&#125; $&#123;student.lastName&#125; </span><br><span class="line">	&lt;br&gt;</span><br><span class="line">	The student<span class="string">&#x27;s country is: $&#123;student.country&#125;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种写法是吧所有的选项都在jsp里面列出来，但是在我们真正的项目中，我们往往是从数据库中读取数据然后显示一个下拉菜单。<br><em>student.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String firstName;</span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	<span class="keyword">private</span> String country;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> LinkedHashMap&lt;String, String&gt; countryOptions;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//模仿从数据库拿数据的过程</span></span><br><span class="line">		countryOptions = <span class="keyword">new</span> LinkedHashMap&lt;String, String&gt;();</span><br><span class="line">		countryOptions.put(<span class="string">&quot;BR&quot;</span>, <span class="string">&quot;Brasil&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;FR&quot;</span>, <span class="string">&quot;France&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;DE&quot;</span>, <span class="string">&quot;Germany&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;IN&quot;</span>, <span class="string">&quot;India&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;BR&quot;</span>, <span class="string">&quot;Brasil&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> LinkedHashMap&lt;String, String&gt; <span class="title">getCountryOptions</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> countryOptions;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCountry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> country;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCountry</span><span class="params">(String country)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.country = country;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>student-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">    </span><br><span class="line">&lt;!-- 用了这一句我们才能使用Form Tags --&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Registration Form&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- modelAttribute对应着我们加入model的对象的名字 --&gt;</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;processForm&quot;</span> modelAttribute=<span class="string">&quot;student&quot;</span>&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Text Fields --&gt;</span><br><span class="line">		&lt;!-- path对应着对象的变量名 --&gt;</span><br><span class="line">		First Name: &lt;form:input path=<span class="string">&quot;firstName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Last Name: &lt;form:input path=<span class="string">&quot;lastName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Dropdown Lists --&gt;</span><br><span class="line">		Country: </span><br><span class="line">		&lt;form:select path=<span class="string">&quot;country&quot;</span>&gt;</span><br><span class="line">		&lt;!-- items指向的是java中的一个collection。Spring会call student.getCountryOptions() --&gt;</span><br><span class="line">			&lt;form:options items=<span class="string">&quot;$&#123;student.countryOptions&#125;&quot;</span>/&gt;</span><br><span class="line">		&lt;/form:select&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span>/&gt;</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>Radio buttons</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Radio Buttons --&gt;</span><br><span class="line">Favorite Languages:</span><br><span class="line">Java&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;Java&quot;</span>/&gt;</span><br><span class="line">C#&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;C#&quot;</span>/&gt;</span><br><span class="line">PHP&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;JaPHPva&quot;</span>/&gt;</span><br><span class="line">Ruby&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;Ruby&quot;</span>/&gt;</span><br><span class="line">&lt;br&gt;</span><br></pre></td></tr></table></figure>
<p>当我们提交form的时候，会call setFavoriteLanguage()函数。<br>在student-confirmation.jsp页面中的<code>$&#123;student.favoriteLanguage&#125;</code>会call student.getFavoriteLanguage()。</p>
<p><strong>Ckeckboxes</strong><br><em>student-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">    </span><br><span class="line">&lt;!-- 用了这一句我们才能使用Form Tags --&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Registration Form&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- modelAttribute对应着我们加入model的对象的名字 --&gt;</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;processForm&quot;</span> modelAttribute=<span class="string">&quot;student&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Text Fields --&gt;</span><br><span class="line">		&lt;!-- path对应着对象的变量名 --&gt;</span><br><span class="line">		First Name: &lt;form:input path=<span class="string">&quot;firstName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Last Name: &lt;form:input path=<span class="string">&quot;lastName&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Dropdown Lists --&gt;</span><br><span class="line">		Country: </span><br><span class="line">		&lt;form:select path=<span class="string">&quot;country&quot;</span>&gt;</span><br><span class="line">		&lt;!-- items指向的是java中的一个collection。Spring会call student.getCountryOptions() --&gt;</span><br><span class="line">			&lt;form:options items=<span class="string">&quot;$&#123;student.countryOptions&#125;&quot;</span>/&gt;</span><br><span class="line">		&lt;/form:select&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- Radio Buttons --&gt;</span><br><span class="line">		Favorite Languages:</span><br><span class="line">		Java&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;Java&quot;</span>/&gt;</span><br><span class="line">		C#&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;C#&quot;</span>/&gt;</span><br><span class="line">		PHP&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;JaPHPva&quot;</span>/&gt;</span><br><span class="line">		Ruby&lt;form:radiobutton path=<span class="string">&quot;favoriteLanguage&quot;</span> value=<span class="string">&quot;Ruby&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;!-- checkbox --&gt;</span><br><span class="line">		Operating Systems:</span><br><span class="line">		linux&lt;form:checkbox path=<span class="string">&quot;operatingSystems&quot;</span> value=<span class="string">&quot;linux&quot;</span> /&gt;</span><br><span class="line">		mac&lt;form:checkbox path=<span class="string">&quot;operatingSystems&quot;</span> value=<span class="string">&quot;mac&quot;</span> /&gt;</span><br><span class="line">		windows&lt;form:checkbox path=<span class="string">&quot;operatingSystems&quot;</span> value=<span class="string">&quot;windows&quot;</span> /&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span>/&gt;</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p><em>Student.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String firstName;</span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	<span class="keyword">private</span> String country;</span><br><span class="line">	<span class="keyword">private</span> String favoriteLanguage;</span><br><span class="line">	<span class="keyword">private</span> String[] operatingSystems;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String[] getOperatingSystems() &#123;</span><br><span class="line">		<span class="keyword">return</span> operatingSystems;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOperatingSystems</span><span class="params">(String[] operatingSystems)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.operatingSystems = operatingSystems;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFavoriteLanguage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> favoriteLanguage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFavoriteLanguage</span><span class="params">(String favoriteLanguage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.favoriteLanguage = favoriteLanguage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">private</span> LinkedHashMap&lt;String, String&gt; countryOptions;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//模仿从数据库拿数据的过程</span></span><br><span class="line">		countryOptions = <span class="keyword">new</span> LinkedHashMap&lt;String, String&gt;();</span><br><span class="line">		countryOptions.put(<span class="string">&quot;BR&quot;</span>, <span class="string">&quot;Brasil&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;FR&quot;</span>, <span class="string">&quot;France&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;DE&quot;</span>, <span class="string">&quot;Germany&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;IN&quot;</span>, <span class="string">&quot;India&quot;</span>);</span><br><span class="line">		countryOptions.put(<span class="string">&quot;BR&quot;</span>, <span class="string">&quot;Brasil&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> LinkedHashMap&lt;String, String&gt; <span class="title">getCountryOptions</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> countryOptions;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCountry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> country;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCountry</span><span class="params">(String country)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.country = country;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于checkboxes可以选多个，所以这里是数组。</p>
<p><em>student-confirmation.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 使用jstl，这样我们才能使用<span class="keyword">for</span> loop --&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Student Confirmation&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	The student is confirmed: $&#123;student.firstName&#125; $&#123;student.lastName&#125; </span><br><span class="line">	&lt;br&gt;</span><br><span class="line">	The student<span class="string">&#x27;s country is: $&#123;student.country&#125;</span></span><br><span class="line"><span class="string">	&lt;br&gt;</span></span><br><span class="line"><span class="string">	Favorite Language is: $&#123;student.favoriteLanguage&#125;</span></span><br><span class="line"><span class="string">	&lt;br&gt;</span></span><br><span class="line"><span class="string">	Operating Systems is: </span></span><br><span class="line"><span class="string">	&lt;ul&gt;</span></span><br><span class="line"><span class="string">			&lt;!-- jstl --&gt;</span></span><br><span class="line"><span class="string">		&lt;c:forEach var=&quot;temp&quot; items=&quot;$&#123;student.operatingSystems&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">			&lt;li&gt;$&#123;temp&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="string">		&lt;/c:forEach&gt;</span></span><br><span class="line"><span class="string">	&lt;/ul&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用jstl去做for loop。</p>
<h2 id="Form-Validation"><a href="#Form-Validation" class="headerlink" title="Form Validation"></a>Form Validation</h2><p>Java’s Standard Bean Validation API:</p>
<ul>
<li>Java has a standard Bean validation API</li>
<li>defines a metadata model and API for entity validation</li>
<li>not tied to either the web tier or the persistence tier</li>
<li>available for server-side apps and also client-side JavaFX/Swing apps</li>
</ul>
<p>Spring and validation</p>
<ul>
<li>Spring version 4 and higher supports Beans Validation API</li>
<li>Preferred method for validation when building Spring apps</li>
<li>Simply add Validation JARs to our project</li>
</ul>
<p>Validation features include: required, validate length， validate numbers, validate with regular expressions, custom validation</p>
<p>我们使用的Validation JAR是Hibernate Team开发的。<a target="_blank" rel="noopener" href="https://hibernate.org/validator/">https://hibernate.org/validator/</a></p>
<hr>
<p><strong>Validate Required Fields</strong><br>开发流程：</p>
<ul>
<li>Add validation rule to Customer class</li>
</ul>
<p><em>Customer.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Size;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String firstName;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@NotNull(message = &quot;is required&quot;)</span></span><br><span class="line">	<span class="meta">@Size(min=1)</span></span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Display error messages on HTML form</li>
</ul>
<p><em>customer-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Customer Register page&lt;/title&gt;</span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">	.error &#123;color:red&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">Fill out the form. * means required.</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;processForm&quot;</span> modelAttribute=<span class="string">&quot;customer&quot;</span>&gt;</span><br><span class="line">		First Name: &lt;form:input path=<span class="string">&quot;firstName&quot;</span> /&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		<span class="function">Last <span class="title">Name</span> <span class="params">(*)</span>: &lt;form:input path</span>=<span class="string">&quot;lastName&quot;</span> /&gt;</span><br><span class="line">		&lt;form:errors path=<span class="string">&quot;lastName&quot;</span> cssClass=<span class="string">&quot;error&quot;</span> /&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Submit&quot;</span> /&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>Perform validation in the Controller class</li>
</ul>
<p><em>ConstomerContoller.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindingResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ModelAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/customer&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/showForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">		model.addAttribute(<span class="string">&quot;customer&quot;</span>, <span class="keyword">new</span> Customer());</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;customer-form&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/processForm&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">processForm</span><span class="params">(<span class="meta">@Valid</span> <span class="meta">@ModelAttribute</span> Customer theCustomer, BindingResult bindingResult)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(bindingResult.hasErrors()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&quot;customer-form&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;customer-confirmation&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Valid注解可以判断Validation是否符合并可以在后面跟一个BindingResult参数。</p>
<ul>
<li>Update confirmation page</li>
</ul>
<p><em>cutomer-confirmation.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Customer Confirmation Page&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	The customer is confirmed: $&#123;customer.firstName&#125; $&#123;customer.lastName&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>现在还有一个问题是如果我们的lastName是whitespaces时，我们的validation不能检测到。<br>我们采用的方法是使用@InitBinder，它的作用是pre-process each web request to our controller.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add an initbinder</span></span><br><span class="line"><span class="comment">// remove leading and trailing whitespace</span></span><br><span class="line"><span class="meta">@InitBinder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InitBinder</span><span class="params">(WebDataBinder dataBinder)</span> </span>&#123;</span><br><span class="line">	StringTrimmerEditor stringTrimmerEditor = <span class="keyword">new</span> StringTrimmerEditor(<span class="keyword">true</span>);</span><br><span class="line">	dataBinder.registerCustomEditor(StringTrimmerEditor.class, stringTrimmerEditor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>StringTrimmerEditor类会帮我们去掉leading和trailing whitespace，去掉以后还会检查输入是不是长度为零，为零的话会将其变为null。</p>
<hr>
<p><strong>Validate Number Range</strong></p>
<p>开发流程：</p>
<ul>
<li>Add validation rule to Customer class</li>
</ul>
<p><em>Customer.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Min(value=0, message = &quot;must be greater or equal to 0&quot;)</span></span><br><span class="line"><span class="meta">@Max(value=10, message = &quot;must be less or equal to 10&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> freePasses;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFreePasses</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> freePasses;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFreePasses</span><span class="params">(<span class="keyword">int</span> freePasses)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.freePasses = freePasses;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Display error messages on HTML form</li>
</ul>
<p><em>customer-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Free Passes: &lt;form:input path=<span class="string">&quot;freePasses&quot;</span> /&gt;</span><br><span class="line">&lt;form:errors path=<span class="string">&quot;freePasses&quot;</span> cssClass=<span class="string">&quot;error&quot;</span> &gt;&lt;/form:errors&gt;</span><br><span class="line">&lt;br&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>Perform validation in the Controller class<br>这一步不用改了，就是@Valid注解</li>
<li>Update confirmation page</li>
</ul>
<p>如果我们还想要freePasses非空，那么我们可以加入@notNull注解，但是错误信息显示int是不能处理not null的，所以我们将其转换为Integer。但这个时候我们如果再输入一大堆String，错误信息会是”不能将String转为Integer”。<br>我们的解决办法是加入custom error message。（<a target="_blank" rel="noopener" href="https://www.udemy.com/course/spring-hibernate-tutorial/learn/lecture/6747542#questions%EF%BC%89">https://www.udemy.com/course/spring-hibernate-tutorial/learn/lecture/6747542#questions）</a></p>
<hr>
<p><strong>Validation with regular expression</strong></p>
<p>开发流程：</p>
<ul>
<li>Add validation rule to Customer class</li>
</ul>
<p><em>Customer.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pattern(regexp = &quot;[a-zA-Z0-9]&#123;5&#125;&quot;, message = &quot;only 5 chars/digits&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String postalCode;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPostalCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> postalCode;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPostalCode</span><span class="params">(String postalCode)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.postalCode = postalCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Display error messages on HTML form</li>
</ul>
<p><em>customer-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Postal Code: &lt;form:input path=<span class="string">&quot;postalCode&quot;</span> /&gt;</span><br><span class="line">&lt;form:errors path=<span class="string">&quot;postalCode&quot;</span> cssClass=<span class="string">&quot;error&quot;</span> &gt;&lt;/form:errors&gt;</span><br><span class="line">&lt;br&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>Perform validation in the Controller class<br>这一步不用改了，就是@Valid注解和BindingReasult</li>
<li>Update confirmation page</li>
</ul>
<hr>
<p><strong>Custom Validation(A Custom Annotation)</strong><br>为我们的coursecode定制一个validation：前缀必须为luv<br>开发流程</p>
<ul>
<li>Create custom validation rule<ul>
<li>Create @CourceCode annotation</li>
</ul>
  <em>CourseCode.java</em>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc.validation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Constraint;</span><br><span class="line"><span class="keyword">import</span> javax.validation.Payload;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Constraint(validatedBy = CourseCodeConstrainValidator.class)</span> <span class="comment">//helper class that contains business rules/validation logic</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.FIELD&#125;)</span> <span class="comment">//can apply our annotation to a method or field</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="comment">//Retain this annotation in the Java class file. Process it at runtime</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> CourceCode &#123;</span><br><span class="line">	<span class="comment">//define default course code</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> &quot;LUV&quot;</span>;</span><br><span class="line">	<span class="comment">//define default error message</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">message</span><span class="params">()</span> <span class="keyword">default</span> &quot;Must start with LUV&quot;</span>;</span><br><span class="line">	<span class="comment">//define default groups</span></span><br><span class="line">	<span class="keyword">public</span> Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">	<span class="comment">//define default payload</span></span><br><span class="line">	<span class="keyword">public</span> Class&lt;? extends Payload&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>Create CourseCodeConstraintValidator</li>
</ul>
  <em>CourseCodeConstrainValidator.class</em>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.mvc.validation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.ConstraintValidator;</span><br><span class="line"><span class="keyword">import</span> javax.validation.ConstraintValidatorContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseCodeConstrainValidator</span> <span class="keyword">implements</span> <span class="title">ConstraintValidator</span>&lt;<span class="title">CourseCode</span>, <span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String coursePrefix;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">(CourseCode theCourseCode)</span> </span>&#123;</span><br><span class="line">		coursePrefix = theCourseCode.value();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(String theCode, ConstraintValidatorContext constraintValidatorContext)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">boolean</span> result;</span><br><span class="line">		<span class="keyword">if</span>(theCode!=<span class="keyword">null</span>) &#123;</span><br><span class="line">			result = theCode.startsWith(coursePrefix);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			result = <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Add validation rule to Customer Class</li>
</ul>
<p><em>Customer.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CourseCode(value = &quot;luv&quot;, message=&quot;must start with luv&quot; )</span></span><br><span class="line"><span class="keyword">private</span> String courseCode;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getCourseCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> courseCode;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseCode</span><span class="params">(String courseCode)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.courseCode = courseCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Display error messages on HTML form</li>
</ul>
<p><em>customer-form.jsp</em></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Course Code: &lt;form:input path=<span class="string">&quot;courseCode&quot;</span> /&gt;</span><br><span class="line">&lt;form:errors path=<span class="string">&quot;courseCode&quot;</span> cssClass=<span class="string">&quot;error&quot;</span> &gt;&lt;/form:errors&gt;</span><br><span class="line">&lt;br&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>Update confirmation page</li>
</ul>
<h2 id="Bonus-Deploying-your-App-to-Tomcat-as-a-Web-Application-Archive-WAR-file"><a href="#Bonus-Deploying-your-App-to-Tomcat-as-a-Web-Application-Archive-WAR-file" class="headerlink" title="Bonus: Deploying your App to Tomcat as a Web Application Archive (WAR) file**"></a>Bonus: Deploying your App to Tomcat as a Web Application Archive (WAR) file**</h2><p>When you deploy your Java web apps, you can make use of a Web Application Archive (WAR) file.</p>
<p>The Web Application Archive (WAR) file is a compressed version of your web application. It uses the zip file format but the file has the .war extension.</p>
<p>If you are using Eclipse, then the best way to visualize it is think of your “WebContent” directory being compressed as a zip file with the .war extension.</p>
<p>This includes all of your web pages, images, css etc. It also includes the WEB-INF directory which includes your classes in WEB-INF/classes and supporting JAR files in WEB-INF/lib.</p>
<p>The WAR file format is part of the Java EE / Servlet specification. As a result, all Java EE servers support this format (ie jboss, weblogic, websphere, glassfish and tomcat).</p>
<p>Below, I provide steps on how to create a WAR file in Eclipse. I also show how to deploy the WAR file on Tomcat.</p>
<ol>
<li><p>In Eclipse, stop Tomcat</p>
</li>
<li><p>Right-click your project and select Export &gt; WAR File</p>
</li>
<li><p>In the Destination field, enter: <any-directory>/mycoolapp.war</p>
</li>
<li><p>Outside of Eclipse, start Tomcat</p>
</li>
</ol>
<ul>
<li>If you are using MS Windows, then you should find it on the Start menu</li>
</ul>
<ol start="5">
<li><p>Make sure Tomcat is up and running by visiting: <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a></p>
</li>
<li><p>Deploy your new WAR file by copying it to <tomcat-install-directory>\webapps</p>
</li>
</ol>
<p>Give it about 10-15 seconds to make the deployment. You’ll know the deployment is over because you’ll see a new folder created in webapps … with your WAR file name.</p>
<ol start="7">
<li>Visit your new app. If your war file was: mycoolapp.war then you can access it with:  <a target="_blank" rel="noopener" href="http://localhost:8080/mycoolapp/">http://localhost:8080/mycoolapp/</a></li>
</ol>
<h1 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h1><p>Hibernate is a framework for persisting/saving Java Objects in a database.</p>
<p>Benefits of Hibernate: 1. Hibernate handles all of the low-level SQL 2. Minimizes the amount of JDBC code you have to develop 3.Hibernate provides the Object-to-Relational Mapping(ORM)</p>
<p>JDBC(Java Database Connection)是Java web程序连接数据库的时候使用的库文件，但是它的问题是需要手动写SQL语句。Hibernate是建立在JDBC上的ORM框架，本质上还是使用JDBC，只不过帮我们做好了封装。</p>
<p>开发Hibernate需要的其他库：1.JDK 2.Database Server(MySQL) 3.Hibernate JAR files and JDBC driver.</p>
<h2 id="Configuration-1"><a href="#Configuration-1" class="headerlink" title="Configuration"></a>Configuration</h2><ul>
<li>Add Hibernate Configuration file</li>
</ul>
<p><em>hibernate.cfg.xml</em></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- JDBC Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.driver_class&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/hb_student_tracker?useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.username&quot;</span>&gt;</span>hbstudent<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.password&quot;</span>&gt;</span>hbstudent<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- JDBC connection pool settings ... using built-in test pool --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connection.pool_size&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Select our SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Echo the SQL to stdout --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- Set the current session context --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;current_session_context_class&quot;</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Annotate Java Class<ul>
<li>Map class to database</li>
<li>Map fields to database columns</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.hibernate.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name=&quot;student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue(strategy=GenerationType.IDENTITY)</span></span><br><span class="line">	<span class="meta">@Column(name=&quot;id&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name=&quot;first_name&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String firstName;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Column(name=&quot;last_name&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Column(name=&quot;email&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String firstName, String lastName, String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> firstName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//for debug</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Student [id=&quot;</span> + id + <span class="string">&quot;, firstName=&quot;</span> + firstName + <span class="string">&quot;, lastName=&quot;</span> + lastName + <span class="string">&quot;, email=&quot;</span> + email + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>Why we are using JPA Annotation instead of Hibernate ?</p>
<p>For example, why we are not using this org.hibernate.annotations.Entity?</p>
<p>ANSWER:<br>JPA is a standard specification. Hibernate is an implementation of the JPA specification.</p>
<p>Hibernate implements all of the JPA annotations.</p>
<p>The Hibernate team recommends the use of JPA annotations as a best practice.</p>
<h2 id="Hibernate-CRUD"><a href="#Hibernate-CRUD" class="headerlink" title="Hibernate CRUD"></a>Hibernate CRUD</h2><p>Two Key Players:<br>    - SessionFactory<br>        - Reads the hibernate config file<br>        - Creates Session objects<br>        - Heavy-weight object<br>        - Only create once in your app<br>    - Session<br>        - Wraps a JDBC connection<br>        - Main object used to save/retrieve objects<br>        - Short-lived object<br>        - Retrieve from session-factory</p>
<hr>
<p><strong>Create Object</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.hibernate.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.hibernate.demo.entity.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateStudentDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//create session factory</span></span><br><span class="line">		SessionFactory factory = <span class="keyword">new</span> Configuration()</span><br><span class="line">								.configure(<span class="string">&quot;hibernate.cfg.xml&quot;</span>)</span><br><span class="line">								.addAnnotatedClass(Student.class)</span><br><span class="line">								.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a session</span></span><br><span class="line">		Session session = factory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//use the session object to save Java Object</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//Create a student object</span></span><br><span class="line">			System.out.println(<span class="string">&quot;Creating a new student object&quot;</span>);</span><br><span class="line">			Student newStudent = <span class="keyword">new</span> Student(<span class="string">&quot;shiyu&quot;</span>, <span class="string">&quot;liu&quot;</span>, <span class="string">&quot;shiyuliucu@gmail.com&quot;</span>);</span><br><span class="line">			<span class="comment">//Start a transaction</span></span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			<span class="comment">//Save the student object</span></span><br><span class="line">			System.out.println(<span class="string">&quot;Saving the student...&quot;</span>);</span><br><span class="line">			session.save(newStudent);</span><br><span class="line">			<span class="comment">//Commit transaction</span></span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			factory.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Read Objects</strong><br><code>Student myStudent = session.get(Student.class, newStudent.getId());</code></p>
<p><strong>Query Objects</strong><br>Hibernate使用HQL进行query，其实就是SQL。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.hibernate.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.hibernate.demo.entity.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryStudentDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//create session factory</span></span><br><span class="line">		SessionFactory factory = <span class="keyword">new</span> Configuration()</span><br><span class="line">								.configure(<span class="string">&quot;hibernate.cfg.xml&quot;</span>)</span><br><span class="line">								.addAnnotatedClass(Student.class)</span><br><span class="line">								.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a session</span></span><br><span class="line">		Session session = factory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//use the session object to save Java Object</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//Start a transaction</span></span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//query students</span></span><br><span class="line">			<span class="comment">//这里from Student的Student是类的名字</span></span><br><span class="line">			List&lt;Student&gt; theStudents = session.createQuery(<span class="string">&quot;from Student&quot;</span>).getResultList();</span><br><span class="line">			<span class="comment">//display students</span></span><br><span class="line">			<span class="keyword">for</span>(Student s:theStudents) &#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//query students: lastName=&quot;liu&quot;</span></span><br><span class="line">			<span class="comment">//use Java property name, not database column name</span></span><br><span class="line">			theStudents = session.createQuery(<span class="string">&quot;from Student s where s.lastName=&#x27;liu&#x27; &quot;</span>).getResultList();</span><br><span class="line">			<span class="comment">//display students</span></span><br><span class="line">			<span class="keyword">for</span>(Student s:theStudents) &#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//query students: lastName=&quot;liu&quot; or fistName=&quot;amy&quot;</span></span><br><span class="line">			theStudents = session.createQuery(<span class="string">&quot;from Student s where s.lastName=&#x27;liu&#x27; OR s.firstName=&#x27;amy&#x27; &quot;</span>).getResultList();</span><br><span class="line">			<span class="comment">//display students</span></span><br><span class="line">			<span class="keyword">for</span>(Student s:theStudents) &#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//query students where email like %qq.com&quot;</span></span><br><span class="line">			theStudents = session.createQuery(<span class="string">&quot;from Student s where s.email LIKE &#x27;%qq.com&#x27; &quot;</span>).getResultList();</span><br><span class="line">			<span class="comment">//display students</span></span><br><span class="line">			<span class="keyword">for</span>(Student s:theStudents) &#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//Commit transaction</span></span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			factory.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Update Objects</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.hibernate.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.hibernate.demo.entity.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateStudentDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//create session factory</span></span><br><span class="line">		SessionFactory factory = <span class="keyword">new</span> Configuration()</span><br><span class="line">								.configure(<span class="string">&quot;hibernate.cfg.xml&quot;</span>)</span><br><span class="line">								.addAnnotatedClass(Student.class)</span><br><span class="line">								.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a session</span></span><br><span class="line">		Session session = factory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//use the session object to save Java Object</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			<span class="keyword">int</span> studentId = <span class="number">1</span>;</span><br><span class="line">			Student theStudent = session.get(Student.class, studentId);</span><br><span class="line">			<span class="comment">//update the firstName where id==1</span></span><br><span class="line">			theStudent.setFirstName(<span class="string">&quot;Cindy&quot;</span>);</span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//update all student email with liushiyu@gmail</span></span><br><span class="line">			session = factory.getCurrentSession();</span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			session.createQuery(<span class="string">&quot;UPDATE Student SET email=&#x27;liushiyu@gmail&#x27; &quot;</span>).executeUpdate();</span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			factory.close();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Delete Objects</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.hibernate.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.hibernate.demo.entity.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeleteStudentDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//create session factory</span></span><br><span class="line">		SessionFactory factory = <span class="keyword">new</span> Configuration()</span><br><span class="line">								.configure(<span class="string">&quot;hibernate.cfg.xml&quot;</span>)</span><br><span class="line">								.addAnnotatedClass(Student.class)</span><br><span class="line">								.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a session</span></span><br><span class="line">		Session session = factory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//use the session object to save Java Object</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			<span class="keyword">int</span> studentId = <span class="number">1</span>;</span><br><span class="line">			Student theStudent = session.get(Student.class, studentId);</span><br><span class="line">			<span class="comment">//delete the student where id==1</span></span><br><span class="line">			session.delete(theStudent);</span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//delete student where id==2</span></span><br><span class="line">			session = factory.getCurrentSession();</span><br><span class="line">			session.beginTransaction();</span><br><span class="line">			session.createQuery(<span class="string">&quot;DELETE from Student  WHERE id=2 &quot;</span>).executeUpdate();</span><br><span class="line">			session.getTransaction().commit();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			factory.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="SpringMVC-Hibernate"><a href="#SpringMVC-Hibernate" class="headerlink" title="SpringMVC + Hibernate"></a>SpringMVC + Hibernate</h1><h2 id="Configuration-2"><a href="#Configuration-2" class="headerlink" title="Configuration"></a>Configuration</h2><ol>
<li>Define database datasource/connection pool</li>
<li>Setup Hibernate session factory</li>
<li>Setup Hibernate transaction manager</li>
<li>Enable configuration of transactional annotations<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx </span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Add support for component scanning --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.luv2code.springdemo&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Add support for conversion, formatting and validation support --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Define Spring MVC view resolver --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/view/&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Step 1: Define Database DataSource / connection pool --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myDataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/web_customer_tracker?useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;springstudent&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;springstudent&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- these are connection pool properties for C3P0 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30000&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- Step 2: Setup Hibernate session factory --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myDataSource&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;packagesToScan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.luv2code.springdemo.entity&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernateProperties&quot;</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">		   <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>	  </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Step 3: Setup Hibernate transaction manager --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myTransactionManager&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- Step 4: Enable configuration of transactional behavior based on annotations --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;myTransactionManager&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="DAO"><a href="#DAO" class="headerlink" title="DAO"></a>DAO</h2><p>Data Access Object:  </p>
<ul>
<li>Responsible for interfacing with the database</li>
<li>This is a common design pattern: DAO</li>
</ul>
<p>由于我们已经xml中设置了<code>&lt;property name=&quot;packagesToScan&quot; value=&quot;com.luv2code.springdemo.entity&quot; /&gt;</code>，所以我们不需要像在普通的Hibernate项目中那样手动说明Entity Class(Java中与数据库一一对应的类叫做Entity Class):   <code>SessionFactory factory = new Configuration().configure(&quot;hibernate.cfg.xml&quot;).addAnnotatedClass(Student.class).buildSessionFactory();</code>。Spring会自动去扫描@Entity。</p>
<p><img src="/images/blog/Spring/DAO1.png"><br>DAO层需要SessionFactory，SessionFactory需要DataSource，这俩都是dependency，我们可以使用依赖注入。DataSource已经被自动注入好了，我们xml配置中有<code>&lt;property name=&quot;dataSource&quot; ref=&quot;myDataSource&quot; /&gt;</code>，这是setter injection，所以如果我们去看org.springframework.orm.hibernate5.LocalSessionFactoryBean的源码的话就会发现它实现了setter injection。<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-framework/blob/master/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBean.java">https://github.com/spring-projects/spring-framework/blob/master/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBean.java</a></p>
<p>接下来需要做的就是：<br>1.Define DAO interface<br><em>CustomerDAO.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CustomerDAO</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">getCustomers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Define DAO implementation(inject the session factory)<br>Spring @Transactional: Automatically begin and end a trasaction for your Hibernate code, no need for you to explicitly do this in your code.(The Spring magic happens behind the scenes)<br>Spring @Repository: 我们之前已经见过@Controller，这里我们的DAO implementation需要使用@Repository。It will automatically register DAO implementation(Component auto-scanning) and also provide translation of any JDBC related exceptions.</li>
</ol>
<p><em>CustomerDAOImpl</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.query.Query;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerDAOImpl</span> <span class="keyword">implements</span> <span class="title">CustomerDAO</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//need to inject the session factory</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> SessionFactory sessionFactory;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">getCustomers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//get current hibernate session</span></span><br><span class="line">		Session currentSession = sessionFactory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a query</span></span><br><span class="line">		Query&lt;Customer&gt; theQuery = currentSession.createQuery(<span class="string">&quot;from Customer&quot;</span>, Customer.class);</span><br><span class="line">		<span class="comment">//execute query and get result list</span></span><br><span class="line">		List&lt;Customer&gt; customers = theQuery.getResultList();</span><br><span class="line">		<span class="comment">//return the result</span></span><br><span class="line">		<span class="keyword">return</span> customers;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>Inject DAO into Controller</li>
</ol>
<p><em>CustomerController.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.dao.CustomerDAO;</span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/customer&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//need to inject the customer DAO</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> CustomerDAO customerDAO;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">listCustomers</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//get customers form dao</span></span><br><span class="line">		List&lt;Customer&gt; customers = customerDAO.getCustomers();</span><br><span class="line">		<span class="comment">//add the customers to the model</span></span><br><span class="line">		model.addAttribute(<span class="string">&quot;customers&quot;</span>, customers);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;list-customers&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Adding-CSS"><a href="#Adding-CSS" class="headerlink" title="Adding CSS"></a>Adding CSS</h2><p>开发流程：</p>
<ol>
<li>Place CSS in a “resourses” directory</li>
<li>Configure Spring to serve up “resources” directory</li>
</ol>
<p><em>spring-mvc-crud-demo-servlet.xml</em></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Add support for reading web resources : css, images, js, etc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">&quot;/resources/&quot;</span> <span class="attr">mapping</span>=<span class="string">&quot;/resources/**&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里<code>mapping=&quot;/resources/**&quot;</code>中的**的意思是recursively的去subfolder里寻找资源文件。<br>3. Reference CSS in your JSP</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link type=<span class="string">&quot;text/css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/resources/css/style.css&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Refactor-Add-a-service-layer"><a href="#Refactor-Add-a-service-layer" class="headerlink" title="Refactor: Add a service layer"></a>Refactor: Add a service layer</h2><p><img src="/images/blog/Spring/service1.png"><br>Purpose of Service Layer</p>
<ol>
<li>Service Facade design pattern</li>
<li>Intermediate layer for customer business logic</li>
<li>Integrate data from mutiple sources(DAO/repositories)<br><img src="/images/blog/Spring/service2.png"></li>
</ol>
<p>我们已经使用过@Controller和@Repository，分别用于Controller层和DAO层。Service我们使用的是@Service。这三个Annotation都继承与@Component，所以也都会被自动扫描。</p>
<p>开发流程：</p>
<ol>
<li>Define Service interface</li>
<li>Define Service implementation：这里我们要把DAO注入到Service层，再把Service层注入到Controller层。同时我们把@Transational注解改到Service层去。</li>
</ol>
<p><em>CustomerServiceImpl.java</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.service;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.dao.CustomerDAO;</span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerServiceImpl</span> <span class="keyword">implements</span> <span class="title">CustomerService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> CustomerDAO customerDAO;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="comment">//define transaction in service layer</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">getCustomers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> customerDAO.getCustomers();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>CustomerDAOImpl</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luv2code.springdemo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.query.Query;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.luv2code.springdemo.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerDAOImpl</span> <span class="keyword">implements</span> <span class="title">CustomerDAO</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//need to inject the session factory</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> SessionFactory sessionFactory;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">getCustomers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//get current hibernate session</span></span><br><span class="line">		Session currentSession = sessionFactory.getCurrentSession();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//create a query</span></span><br><span class="line">		Query&lt;Customer&gt; theQuery = currentSession.createQuery(<span class="string">&quot;from Customer&quot;</span>, Customer.class);</span><br><span class="line">		<span class="comment">//execute query and get result list</span></span><br><span class="line">		List&lt;Customer&gt; customers = theQuery.getResultList();</span><br><span class="line">		<span class="comment">//return the result</span></span><br><span class="line">		<span class="keyword">return</span> customers;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>所以总结一下，Controller层负责接收浏览器的GET/POST请求，DAO层负责与数据库交互获取数据，Service层负责处理从DAO层拿到的数据，处理结束后传回Controller层。</strong></p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Java/">Java</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/01/31/Basics/Thinking%20in%20Java%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Thinking in Java阅读笔记</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/03/28/Backend/Servlets%20and%20JSPs/"><span class="level-item">Servlets and JSPs</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/Shiyu.jpg" alt="Shiyu Liu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Shiyu Liu</p><p class="is-size-6 is-block">Software Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Nashville</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">48</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">11</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ShiyuLiuColumbia" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ShiyuLiuColumbia"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/shiyu-liu-6623a3158/"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:sl4401@columbia.edu"><i class="fas fa-envelope-open"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Inversion-of-control"><span class="level-left"><span class="level-item">1</span><span class="level-item">Inversion of control</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#XML-file-configuration"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">XML file configuration</span></span></a></li><li><a class="level is-mobile" href="#Java-Annotation"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Java Annotation</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Dependency-Injection"><span class="level-left"><span class="level-item">2</span><span class="level-item">Dependency Injection</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#XML-configurarion-Construction-injection"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">XML configurarion - Construction injection</span></span></a></li><li><a class="level is-mobile" href="#XML-configurarion-Setter-injection"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">XML configurarion - Setter injection</span></span></a></li><li><a class="level is-mobile" href="#Java-Annotations-Autowiring-Contructor-Injection"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Java Annotations(Autowiring) - Contructor Injection</span></span></a></li><li><a class="level is-mobile" href="#Java-Annotations-Autowiring-Setter-Injection"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">Java Annotations(Autowiring) - Setter Injection</span></span></a></li><li><a class="level is-mobile" href="#Java-Annotations-Autowiring-Field-Injection"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">Java Annotations(Autowiring) - Field Injection</span></span></a></li><li><a class="level is-mobile" href="#Java-Annotations-Autowiring-Qualifiers"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">Java Annotations(Autowiring) - Qualifiers</span></span></a></li><li><a class="level is-mobile" href="#Some-tips"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">Some tips</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Spring-Beans-Scopes-and-Lifecycle"><span class="level-left"><span class="level-item">3</span><span class="level-item">Spring Beans Scopes and Lifecycle</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Beans-Scopes"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Beans Scopes</span></span></a></li><li><a class="level is-mobile" href="#Beans-lifecycle"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Beans lifecycle</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Spring-Configuration-with-java-code-no-xml"><span class="level-left"><span class="level-item">4</span><span class="level-item">Spring Configuration with java code(no xml)</span></span></a></li><li><a class="level is-mobile" href="#Spring-MVC"><span class="level-left"><span class="level-item">5</span><span class="level-item">Spring MVC</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Configuration"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">Configuration</span></span></a></li><li><a class="level is-mobile" href="#Create-Controllers-and-Views"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">Create Controllers and Views</span></span></a></li><li><a class="level is-mobile" href="#Request-Params-and-Request-Mapping"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">Request Params and Request Mapping</span></span></a></li><li><a class="level is-mobile" href="#Spring-MVC-Form-Tags-and-data-binding"><span class="level-left"><span class="level-item">5.4</span><span class="level-item">Spring MVC Form Tags and data binding</span></span></a></li><li><a class="level is-mobile" href="#Form-Validation"><span class="level-left"><span class="level-item">5.5</span><span class="level-item">Form Validation</span></span></a></li><li><a class="level is-mobile" href="#Bonus-Deploying-your-App-to-Tomcat-as-a-Web-Application-Archive-WAR-file"><span class="level-left"><span class="level-item">5.6</span><span class="level-item">Bonus: Deploying your App to Tomcat as a Web Application Archive (WAR) file**</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Hibernate"><span class="level-left"><span class="level-item">6</span><span class="level-item">Hibernate</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Configuration-1"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">Configuration</span></span></a></li><li><a class="level is-mobile" href="#Hibernate-CRUD"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">Hibernate CRUD</span></span></a></li></ul></li><li><a class="level is-mobile" href="#SpringMVC-Hibernate"><span class="level-left"><span class="level-item">7</span><span class="level-item">SpringMVC + Hibernate</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Configuration-2"><span class="level-left"><span class="level-item">7.1</span><span class="level-item">Configuration</span></span></a></li><li><a class="level is-mobile" href="#DAO"><span class="level-left"><span class="level-item">7.2</span><span class="level-item">DAO</span></span></a></li><li><a class="level is-mobile" href="#Adding-CSS"><span class="level-left"><span class="level-item">7.3</span><span class="level-item">Adding CSS</span></span></a></li><li><a class="level is-mobile" href="#Refactor-Add-a-service-layer"><span class="level-left"><span class="level-item">7.4</span><span class="level-item">Refactor: Add a service layer</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Shiyu - Blog</a><p class="is-size-7"><span>&copy; 2021 Shiyu Liu</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>